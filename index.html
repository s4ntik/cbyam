<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Yum Overlay</title>
  </style>
  <link rel="shortcut icon" href="./favicon.ico">
  <link rel="stylesheet" href="./src/css/app.5af43888.css">
  <link rel="stylesheet" href="./src/css/styles.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Figtree:ital,wght@0,300..900;1,300..900&family=Lexend:wght@100..900&display=swap"
    rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.30.1/moment.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
</head>

<body>
  <!-- Lovense App -->
  <script src=./src/tinymce4.7.5/tinymce.min.js></script>
  <script src=./src/cryptdtx/bundle/cryptdtx.js></script>
  <div id="app"></div>
  <style id="J_styleChange"></style>
  <style id="J_pannelStyleChange"></style>
  <!-- Container for the image, date, and time -->
  <div class="clock-container">
    <div class="clock-wrapper">
      <!-- Date -->
      <div id="date" class="clock-output"></div>
      <!-- Time -->
      <div id="time" class="clock-output"></div>
    </div>
  </div>
  <!-- Countdown Timer -->
  <div id="countdown-container" class="clock-output">
  <!-- SVG Path -->
    <svg version="1.1" viewBox="0 0 475 240" id="logo" xmlns="http://www.w3.org/2000/svg">
      <path class="cls-1"
        d="m57.3 120.9c-7.5 0-14.3-1.6-20.4-4.8s-11.2-9.4-11.2-9.4c-1.7-2.1-1.5-5.3 0.6-7.2l14.2-12.4c2.1-1.8 5.1-1.5 6.8 0.7 0 0 1.5 1.9 3.7 3.3s4.6 2 7.1 2 2.6-0.3 4-0.8 2.6-1.4 3.9-2.6 2.3-2.8 3.3-4.9c1-2 1.6-4 1.6-4 0.8-2.6 2-7 2.7-9.6l12.5-46.1c0.7-2.7 3.6-4.8 6.3-4.8h22.1c2.8 0 4.4 2.2 3.7 4.8l-13.7 51.3c-0.7 2.7-2 7-2.8 9.6 0 0-2.3 7.3-4.7 11.9s-5.2 8.6-8.5 11.9c-3.4 3.4-7.6 6.1-12.7 8-5.1 2-11.2 3-18.2 3z" />
      <path class="cls-1"
        d="m152.7 120.9c-14 0-24.6-3.1-31.8-9.4-7.2-6.2-10.8-14.9-10.8-26.1s1.1-11 1.1-11c0.5-2.7 1.6-7.1 2.3-9.7l10.6-39.5c0.7-2.7 3.6-4.8 6.3-4.8h23.5c2.8 0 4.4 2.2 3.7 4.8l-11.2 41.6c-0.7 2.7-1.7 7-2.3 9.7 0 0-0.1 0.7-0.1 2.8 0 4.1 1.1 7.2 3.4 9.3s5.7 3.1 10.1 3.1 5.2-0.7 7.4-1.7c3.3-1.6 5.9-5.7 7-7.8s1.7-4.2 1.7-4.2c0.8-2.6 2-7 2.8-9.6l11.6-43.3c0.7-2.7 3.5-4.8 6.3-4.8h23.5c2.8 0 4.4 2.2 3.7 4.8l-13 48.3c-0.7 2.7-2 7-2.8 9.6 0 0-2.1 6.7-4.5 11.4s-6.2 9.6-6.2 9.6c-1.8 2.1-5 5.2-7.2 6.9 0 0-6.4 5-13.1 6.9-6.7 2-14 3-21.9 3z" />
      <path class="cls-1"
        d="M228.9,25.2c.7-2.7,3.5-4.8,6.3-4.8h22.9c2.8,0,4.4,2.2,3.7,4.8l-23.9,88.9c-.7,2.7-3.5,4.8-6.3,4.8h-22.9c-2.8,0-4.4-2.2-3.7-4.8l23.9-88.9Z" />
      <path class="cls-1"
        d="m301.4 121.1c-6.9 0-13.3-1-19-3s-10.6-4.9-14.7-8.7-7.3-8.3-9.6-13.6-3.4-11.3-3.4-17.9 1.3-13.7 3.9-20.7 6.5-13.4 11.8-19.2 11.8-10.5 19.8-14.1c7.9-3.7 17.2-5.5 27.8-5.5s10.3 0.7 14.7 2c4.5 1.4 8.4 3.3 11.9 5.8s6.4 5.5 8.7 9.1 3.5 7.1 3.5 7.1c0.9 2.6-0.5 5.6-3 6.7l-20.2 8.8c-2.5 1.1-5.4 0-6.5-2.6 0 0-1-2.4-3.7-4.4s-6-3-9.7-3-7 0.8-10 2.3-5.6 3.6-7.7 6.1-3.8 5.4-4.9 8.7c-1.2 3.2-1.8 6.5-1.8 9.9 0 5.4 1.5 9.6 4.4 12.5 3 2.9 6.6 4.4 11 4.4s7.3-0.9 10.4-2.7 5.3-4 5.3-4c1.9-2 5.2-2.2 7.4-0.5l15 11.8c2.2 1.7 2.4 4.7 0.5 6.7 0 0-7.7 8.1-15 12s-16.2 5.9-26.7 5.9z" />
      <path class="cls-1"
        d="m145.4 221.7c-5.9 0-11.4-0.9-16.3-2.8s-9.2-4.5-12.7-7.7c-3.5-3.3-6.3-7.1-8.3-11.6s-2.9-9.3-2.9-14.4 1.2-12.2 3.6-18c2.4-5.7 5.8-10.8 10-15.2s9.3-7.9 15.1-10.4c5.8-2.6 12.1-3.9 18.9-3.9s11.4 0.9 16.3 2.8 9.2 4.5 12.7 7.7c3.5 3.3 6.3 7.1 8.3 11.6s2.9 9.3 2.9 14.4-1.2 12.2-3.6 18c-2.4 5.7-5.8 10.8-10 15.2s-9.3 7.9-15.1 10.4c-5.8 2.6-12.1 3.9-18.9 3.9zm1.8-23.8c2.8 0 5.4-0.6 7.7-1.9s4.2-2.9 5.8-4.9 2.9-4.3 3.8-6.8 1.3-5.1 1.3-7.6-0.3-4.2-1-6-1.6-3.5-2.8-4.8c-1.2-1.4-2.8-2.5-4.7-3.2-1.9-0.8-4-1.2-6.4-1.2s-5.4 0.6-7.7 1.9-4.2 2.9-5.8 4.9-2.9 4.3-3.8 6.8-1.3 5.1-1.3 7.6 0.3 4.2 1 6 1.6 3.5 2.8 4.8c1.2 1.4 2.8 2.5 4.6 3.2 1.8 0.8 4 1.2 6.5 1.2z" />
      <path class="cls-1"
        d="M207.5,144.1c.7-2.7,3.5-4.8,6.3-4.8h17.1c2.8,0,7.2.1,10,.3,0,0,8.6.5,13.4,1.9,4.8,1.5,7.7,3.7,7.7,3.7,2.2,1.7,5.4,4.8,7.1,6.9,0,0,.6.7,1.6,3.5,1,2.7,1.6,5.7,1.6,8.9,0,5.1-.9,9.7-2.8,13.8-1.8,4.1-4.5,7.7-8,10.6-3.5,3-7.8,5.3-12.9,6.9-5.1,1.6-12.2,2.1-12.2,2.1-2.7.2-7.2.3-10,.3h-1.4c-2.8,0-5.6,2.2-6.3,4.8l-3.3,12.3c-.7,2.7-3.5,4.8-6.3,4.8h-17c-2.8,0-4.4-2.2-3.7-4.8l19.1-71.2ZM227.7,178.9c1.3,0,4.7-.3,7.4-.6,0,0,4-.5,6.4-2.5,2.4-2,3.6-4.6,3.6-7.7v-1.8c-1.1-1.6-2.9-3.6-4.1-4.5l-1.5-.4-1.5-.4c-1.7-.1-4.2-.2-5.6-.2s-3.1,2.2-3.8,4.8l-2.2,8.3c-.7,2.7-.2,4.8,1.2,4.8Z" />
      <path class="cls-1"
        d="M283,144.1c.7-2.7,3.5-4.8,6.3-4.8h17c2.8,0,4.4,2.2,3.7,4.8l-5.1,18.9c-.7,2.7.9,4.8,3.7,4.8h14.7c2.8,0,5.6-2.2,6.3-4.8l5.1-18.9c.7-2.7,3.6-4.8,6.3-4.8h17c2.8,0,4.4,2.2,3.7,4.8l-19.1,71.2c-.7,2.7-3.5,4.8-6.3,4.8h-17c-2.8,0-4.4-2.2-3.7-4.8l5.2-19.3c.7-2.7-1-4.8-3.7-4.8h-14.7c-2.8,0-5.6,2.2-6.3,4.8l-5.2,19.3c-.7,2.7-3.5,4.8-6.3,4.8h-17c-2.8,0-4.4-2.2-3.7-4.8l19.1-71.2Z" />
      <path class="cls-1"
        d="M379,194.1c.7-2.7.6-7-.2-9.6l-12.8-40.5c-.8-2.6.7-4.8,3.5-4.8h18.4c2.8,0,5.5,2.2,6.2,4.9l4.2,17.3c.7,2.7,2.6,3.1,4.3.9l14.9-19.1c1.7-2.2,5.3-3.9,8.1-3.9h22c2.8,0,3.5,1.7,1.7,3.8l-39.4,45.8c-1.8,2.1-3.8,6-4.6,8.6l-4.8,17.8c-.7,2.7-3.5,4.8-6.3,4.8h-17c-2.8,0-4.4-2.2-3.7-4.8l5.6-21.2Z" />
      <path class="cls-1"
        d="M450,23.8c0,.4-.3,1.1-.7,2-1.4,3.3-4.8,9.8-10.1,19.4-5.5,9.8-27.8,45.2-27.8,45.2l-8.6,28.6h-32.9l8.7-32.5-10.6-54.6c-.3-1.5-.8-2.7-1.4-3.7-.5-.7-1.3-1.5-2.3-2.3-.3-.3-.8-.5-1.2-.9-.8-.5-1.1-1.1-1-1.7l.3-1.6c.1-.9.8-1.3,1.8-1.3h20.4c5.9,0,10.2.5,12.8,1.4,2.7.9,4.6,2.5,5.7,4.8s2,5.6,2.7,10l2,14.2,3.2,23.7c.3.4.8.7,1.4.7,1.3,0,2.1-.8,2.4-2.2.1-.9,0-2.3-.2-4.3l-3-22.7-1.8-13.2c-.5-3.5-1-5.7-1.7-6.8-.6-1-1-1.6-1.2-1.9-.1-.3-.2-.7-.1-1.1l.2-1.2c.1-.9.8-1.3,1.8-1.3h37c3.1,0,4.5,1.1,4,3.3Z" />
      <path class="cls-1"
        d="m99.9 196.6c-1.5 8-6.1 14.2-13.6 18.4s-17.4 6.5-29.8 6.5-19.9-1.7-25.2-5.2-7.3-8.6-6-15.2c0.8-4 2.9-7.4 6.4-10s7.5-3.9 12.1-3.9 9.4 1.2 12.1 3.6 3.7 5.6 2.9 9.5c-0.6 3.1-2.1 5.5-4.5 7.2s-5.5 2.7-9.3 2.9c-0.6 0.5-1 1-1.1 1.5s0 1 0.5 1.3 1.1 0.5 1.9 0.5c4 0 7.6-1.3 10.8-3.9s5.1-5.8 5.9-9.6c0.6-3.1 0.5-5.7-0.4-7.7s-2.6-3.9-5.1-5.5-6.1-3.2-10.7-4.7c-5.2-1.6-8.9-4.2-11-7.6s-2.8-7.5-1.8-12.3 3.3-9.1 7-12.8c3.8-3.8 8.7-6.6 14.6-8.9 6.1-2.1 12.9-3.3 20.4-3.3s18.5 1.8 23.8 5.4 7.3 8.6 6.1 15c-0.8 4-3 7.4-6.5 10-3.6 2.6-7.8 3.9-12.7 3.9s-8.9-1.2-11.5-3.6-3.6-5.6-2.8-9.5c0.6-3.1 2.1-5.5 4.5-7.2s5.5-2.7 9.3-2.9c0.6-0.5 1-1 1.1-1.5s0-1-0.5-1.3-1.1-0.5-1.9-0.5c-2.6 0-5 0.6-7.3 1.7-2.3 1.2-4.3 2.8-6.1 4.8-1.6 2-2.8 4.3-3.3 6.9-0.9 4.4 0 8 2.4 10.6 2.4 2.7 7 5 13.9 7 6.3 1.8 10.7 4.4 13.2 7.7 2.4 3.4 3.2 7.5 2.2 12.6z" />
    </svg>
    <!-- Valentine banner: Happy Valentine + flying hearts (added) -->
    <div id="valentine-banner" class="valentine-banner" aria-hidden="false">
      <div id="valentine-text" class="valentine-text">Happy Valentine</div>
      <div id="hearts-container" class="hearts-container" aria-hidden="true"></div>
    </div>
    <style id="valentine-styles">
      /* Valentine banner + hearts (updated) */
      #valentine-banner{
        position: absolute;
        bottom: 65px;
        left: 50%;
        transform: translateX(-50%);
        z-index: 9999;
        pointer-events: none;
        display:flex;
        flex-direction:column;
        align-items:center;
        gap:6px;
      }
      #valentine-text{
        font-family: 'Lexend', Figtree, sans-serif;
        font-weight:800;
        font-size:32px;
        background: linear-gradient(90deg,#ff7aa2,#ff2d63);
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
        text-shadow: 0 6px 20px rgba(255,45,99,0.12);
        letter-spacing:1px;
        opacity: 0;
        transform: translateY(6px) scale(.98);
        transition: opacity 520ms cubic-bezier(.2,.9,.2,1), transform 520ms cubic-bezier(.2,.9,.2,1);
        filter: drop-shadow(0 6px 18px rgba(255,45,99,0.08));
      }
      #valentine-text.visible{ opacity:1; transform: translateY(0) scale(1); animation: valentinePop 480ms cubic-bezier(.2,.9,.2,1); }
      @keyframes valentinePop{ 0%{ transform: translateY(6px) scale(.9); opacity:0 } 60%{ transform: translateY(-2px) scale(1.05); opacity:1 } 100%{ transform: translateY(0) scale(1) } }

      /* logo color change (no rotation) */
      /* smooth transition for the svg fill, override comes from this later rule */
      #logo .cls-1{ transition: fill 600ms cubic-bezier(.2,.9,.2,1), opacity 400ms linear; }
      /* when active, tint the logo to match the Valentine text */
      #logo.logo-valentine .cls-1{ fill: #ff2d63; filter: drop-shadow(0 6px 18px rgba(255,45,99,0.12)); }

      /* floating hearts above the text */
      .hearts-container{ position: absolute; top: -6px; left: 50%; transform: translateX(-50%); width: 360px; height: 110px; pointer-events:none; overflow:visible; }
      .floating-heart{
        position: absolute;
        bottom: 6px;
        will-change: transform, opacity;
        color: #ff3a6b;
        text-shadow: 0 6px 18px rgba(255,45,99,0.12);
        opacity: 0;
        transform-origin: 50% 50%;
        pointer-events: none;
        animation-name: floatUp;
        animation-timing-function: cubic-bezier(.2,.9,.2,1);
        animation-fill-mode: forwards;
      }
      @keyframes floatUp{ 0%{ transform: translateY(0) translateX(0) scale(.85) rotate(0deg); opacity:0 } 10%{ opacity:1 } 100%{ transform: translateY(-140px) translateX(var(--dx,0px)) scale(1.12) rotate(var(--rot,20deg)); opacity:0 } }

      /* keep existing flying-heart style (logo→text) */
      .valentine-heart{
        position: fixed;
        left:0; top:0;
        font-size:20px;
        line-height:1;
        transform: translate(-50%,-50%) scale(1) rotate(0deg);
        transition: transform 1100ms cubic-bezier(.2,.9,.2,1), opacity 1100ms linear;
        will-change: transform, opacity;
        color: #ff3a6b;
        text-shadow: 0 6px 18px rgba(255,45,99,0.12);
        pointer-events: none;
      }
      .valentine-heart.small{ font-size:14px; opacity:0.95; }
      .valentine-heart.big{ font-size:26px; opacity:1; }
      @media (max-width:640px){
        #valentine-text{ font-size:20px; }
        .hearts-container{ width:220px; top:-4px; height:80px; }
      }
    </style>
    <div class="timer">
      <div id="countdown">Stream ends in</div>
      <div id="countdown-display"></div>
    </div>
  </div>
  <!-- JSON Data -->
  <div id="json-data" class="clock-output"></div>
  <!-- Centered Text with a Class -->
  <div class="brb-class">
    <span class="small-text">Don't go anywhere</span>
    <div class="text-gap"></div>
    <span class="big-text"></span>
  </div>
  <!-- Centered Text with a Class -->
  <div class="ending-class">
    <span class="small-text2"></span>
    <div class="text-gap"></div>
    <span class="big-text2">9PM UTC - 5PM EST - 4PM CST</span>
  </div>
  <!-- Percentage -->
  <div id="image-container"></div>

  <!-- Left-center bouncing toy (moved to its own top-level div) -->
  <div id="toy-wrapper">
    <div id="toy-bounce" class="bouncing-toy" style="--toy-badge-bg:#ff6b6b; --toy-badge-color:#fff;">
      <div class="toy-inner">
        <img src="./src/img/toy.png" alt="toy" class="toy-img">
        <div class="toy-badge">Toy</div>
      </div>
    </div>
  </div>

  <!-- Styles for the bouncing toy -->
  <style id="toy-styles">
    /* Position: left center; keeps bouncing forever. Customize via CSS variables on #toy-bounce */
    .bouncing-toy{
      position: fixed;
      left: 15px;
      top: 45%;
      transform: translateY(-50%);
      z-index: 99999;
      pointer-events: none; /* doesn't block clicks */
    }
    .bouncing-toy .toy-inner{
      display: flex;
      flex-direction: column; /* image above, text below */
      align-items: center;
      gap: 8px;
      transform-origin: center;
    }
    .bouncing-toy .toy-img{
      width: 130px;
      height: auto;
      display: block;
      border-radius: 8px;
      background: transparent;
      animation: toyBounce 0.83s infinite; /* image keeps bouncing */
      will-change: transform;
    }
    .toy-badge{
      background: #ff2d89;
      color: var(--toy-badge-color, #fff);
      padding: 10px 12px;
      border-radius: 10px;
      font-weight: 700;
      font-family: monospace;
      font-size: 18px;
      text-shadow: -1px 1px 2px rgba(0, 0, 0, 0.7);
      white-space: normal;
      text-align: center;
      max-width: 300px;
      transition: opacity 260ms ease, transform 260ms cubic-bezier(.2,.9,.2,1);
      will-change: opacity, transform;
      opacity: 1;
    }
    .toy-badge.toy-badge--hidden{
      opacity: 0;
      transform: translateY(6px) scale(.98);
      animation: none; /* stop bounce while swapping */
    }

    @keyframes toyBounce{
  0% { transform: translateX(0) }
  25% { transform: translateY(-9px) }
  35% { transform: translateY(-9px) rotate(17deg) }
  55% { transform: translateY(-9px) rotate(-17deg) }
  65% { transform: translateY(-9px) rotate(17deg) }
  75% { transform: translateY(-9px) rotate(-17deg) }
  100% { transform: translateY(0) rotate(0) }
    }
    @media (max-width:640px){
      .toy-img{ width:48px; }
      .toy-badge{ font-size:12px; padding:5px 8px; }
      .bouncing-toy{ left:10px; }
    }
  </style>

  <script id="toy-script">
    (function(){
      const badge = document.querySelector('#toy-bounce .toy-badge');
      if (!badge) return;

      // messages with per-item durations (ms)
      const items = [
        { text: 'All tips will help me fund my Dream TOYS!', duration: 15000 }, // longer
        { text: 'Thank you!', duration: 5000 } // shorter
      ];

      let idx = 0;
      badge.textContent = items[idx].text;

      let swapTimer = null;

      function doSwap(nextIdx){
        badge.classList.add('toy-badge--hidden');
        setTimeout(()=>{
          badge.textContent = items[nextIdx].text;
          badge.classList.remove('toy-badge--hidden');
          scheduleNext(nextIdx);
        }, 220);
      }

      function scheduleNext(currentIdx){
        clearTimeout(swapTimer);
        const dur = (items[currentIdx] && items[currentIdx].duration) ? items[currentIdx].duration : 2800;
        swapTimer = setTimeout(()=>{
          idx = (currentIdx + 1) % items.length;
          doSwap(idx);
        }, dur);
      }

      // start rotation
      scheduleNext(0);

      // API to set new texts. Accepts array of strings OR array of {text,duration}
      window.setToyBadgeTexts = (arr, defaultDuration = 2800) => {
        if (!Array.isArray(arr) || arr.length === 0) return;
        const newItems = arr.map(v => {
          if (typeof v === 'string') return { text: v, duration: defaultDuration };
          if (v && typeof v === 'object' && 'text' in v) return { text: String(v.text), duration: Number(v.duration) || defaultDuration };
          return null;
        }).filter(Boolean);
        if (newItems.length === 0) return;
        items.length = 0;
        Array.prototype.push.apply(items, newItems);
        idx = 0;
        badge.classList.add('toy-badge--hidden');
        setTimeout(()=>{
          badge.textContent = items[0].text;
          badge.classList.remove('toy-badge--hidden');
          scheduleNext(0);
        }, 220);
      };

      window.stopToyBadgeRotation = () => { clearTimeout(swapTimer); swapTimer = null; };
      window.startToyBadgeRotation = () => { if (!swapTimer) scheduleNext(idx); };

    })();
  </script>

  <!-- Scripts -->
  <script src="./src/js/client.js"></script>
  <script src="./src/js/script.js"></script>
  <script src="./src/js/emoteLibrary.js"></script>
  <script src="./src/js/lovense-app.min.js"></script>
  <script src="./src/js/chunk-libs.d777a9ce.js"></script>
  <script src="./src/js/app.e5054d60.js"></script>
  <script>
    // Valentine hearts: reveal sequence + flying + floating hearts (auto-run after 4s)
    (function(){
      const logo = document.getElementById('logo');
      const valentineText = document.getElementById('valentine-text');
      const heartsContainer = document.getElementById('hearts-container');
      if(!logo || !valentineText || !heartsContainer) return;
      let revealed = false;
      const body = document.body;

      function centerOf(el){
        const r = el.getBoundingClientRect();
        return { x: r.left + r.width/2, y: r.top + r.height/2 };
      }

      // --- flying hearts (logo <-> text) ---
      function spawnHeart(direction){
        const startEl = direction === 'logo->text' ? logo : valentineText;
        const endEl = direction === 'logo->text' ? valentineText : logo;
        const start = centerOf(startEl);
        const end = centerOf(endEl);
        const heart = document.createElement('div');
        heart.className = 'valentine-heart ' + (Math.random()>0.6 ? 'big' : 'small');
        heart.textContent = '❤';
        heart.style.left = start.x + 'px';
        heart.style.top = start.y + 'px';
        heart.style.opacity = '1';
        body.appendChild(heart);
        heart.getBoundingClientRect();
        const dx = end.x - start.x;
        const dy = end.y - start.y;
        const rotate = (Math.random()*80 - 40);
        const scale = 0.8 + Math.random()*0.6;
        heart.style.transform = `translate(${dx}px, ${dy}px) rotate(${rotate}deg) scale(${scale})`;
        heart.style.opacity = '0';
        setTimeout(()=> heart.remove(), 1250);
      }
      let forward = true;
      let flySpawnId = null;
      function startFlyingHearts(){ if (flySpawnId) return; flySpawnId = setInterval(()=>{ spawnHeart(forward? 'logo->text' : 'text->logo'); forward = !forward; }, 500); }
      function stopFlyingHearts(){ if(!flySpawnId) return; clearInterval(flySpawnId); flySpawnId = null; }
      startFlyingHearts();

      // --- floating hearts above the text (triggered on reveal) ---
      let floatId = null;
      function spawnFloatingHeart(){
        const heart = document.createElement('div');
        heart.className = 'floating-heart';
        heart.textContent = '❤';
        const size = 12 + Math.floor(Math.random()*28);
        heart.style.fontSize = size + 'px';
        const maxW = Math.max(heartsContainer.clientWidth, 200);
        const left = Math.floor(10 + Math.random() * (maxW - 20));
        heart.style.left = left + 'px';
        const drift = Math.floor((Math.random() - 0.5) * 160);
        const rot = Math.floor((Math.random() - 0.5) * 60);
        const dur = 1400 + Math.floor(Math.random()*1000);
        heart.style.setProperty('--dx', drift + 'px');
        heart.style.setProperty('--rot', rot + 'deg');
        heart.style.animationDuration = dur + 'ms';
        heartsContainer.appendChild(heart);
        setTimeout(()=> heart.remove(), dur + 50);
      }
      function startFloatingHearts(){ if (floatId) return; floatId = setInterval(()=> { spawnFloatingHeart(); if (Math.random() > 0.6) spawnFloatingHeart(); }, 180); }
      function stopFloatingHearts(){ if(!floatId) return; clearInterval(floatId); floatId = null; }

      // --- reveal / hide cycle (logo color toggle, no rotation) ---
      let cycleTimer = null;
      function revealValentine(){
        if (revealed) return;
        revealed = true;
        stopFlyingHearts();
        // tint the logo to match the banner text
        logo.classList.add('logo-valentine');
        valentineText.classList.add('visible');
        startFloatingHearts();
        // schedule hide after 40s
        if (cycleTimer) clearTimeout(cycleTimer);
        cycleTimer = setTimeout(hideValentine, 30000);
      }
      function hideValentine(){
        if (!revealed) return;
        revealed = false;
        startFlyingHearts();
        logo.classList.remove('logo-valentine');
        valentineText.classList.remove('visible');
        stopFloatingHearts();
        // schedule next reveal after 40s
        if (cycleTimer) clearTimeout(cycleTimer);
        cycleTimer = setTimeout(revealValentine, 40000);
      }
      function toggleValentine(){ (revealed ? hideValentine : revealValentine)(); }
      window.revealValentine = revealValentine;
      window.hideValentine = hideValentine;
      window.toggleValentine = toggleValentine;

      // auto-run after 4s (chosen)
      setTimeout(revealValentine, 4000);

      // pause/resume on visibility change
      document.addEventListener('visibilitychange', ()=> {
        if (document.hidden){
          stopFlyingHearts();
          stopFloatingHearts();
        } else {
          if (!revealed) startFlyingHearts();
          else startFloatingHearts();
        }
      });

    })();
  </script>
  <script>
    // Handle messages from the parent window
    window.addEventListener('message', (event) => {
      if (event.data.type === 'add_image') {
        const {
          id,
          src,
          x,
          y,
          rotation,
          opacity,
          mirror,
          resize
        } = event.data;
        const imgElement = createImageElement(id, src, x, y, rotation, opacity, mirror, resize);
        document.getElementById('image-container').appendChild(imgElement);
      } else if (event.data.type === 'update_image') {
        const {
          id,
          properties
        } = event.data;
        updateImage(id, properties);
      } else if (event.data.type === 'delete_image') {
        const {
          id
        } = event.data;
        const imgElement = document.getElementById(id);
        if (imgElement) {
          imgElement.remove();
        }
      }
    });
  </script>
</body>

</html>
